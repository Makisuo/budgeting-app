datasource db {
  provider = "postgresql"
  url      = env("DIRECT_DATABASE_URL")
}

model Institution {
  id       String  @id @default(uuid())
  name     String
  logo     String?
  provider String

  transactionTotalDays Int @map("transaction_total_days")

  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @default(now()) @map("updated_at")
  deletedAt DateTime? @map("deleted_at")
  Account   Account[]

  @@map("institutions")
}

model Account {
  id       String      @id @default(uuid())
  name     String
  currency String
  type     accountType

  institutionId String      @map("institution_id")
  institution   Institution @relation(fields: [institutionId], references: [id])

  balanceAmount   Float
  balanceCurrency String

  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @default(now()) @map("updated_at")
  deletedAt DateTime? @map("deleted_at")

  @@map("accounts")
}

model Transaction {
  id             String            @id @default(uuid())
  amount         Float
  currency       String
  date           DateTime
  status         transactionStatus
  balance        Float?
  category       String?
  method         String
  name           String
  description    String?
  currencyRate   Float?
  currencySource String?

  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @default(now()) @map("updated_at")
  deletedAt DateTime? @map("deleted_at")
}

enum transactionStatus {
  posted
  pending
}

enum accountType {
  depository
  credit
  other_asset
  loan
  other_liability
}
